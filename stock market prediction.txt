import numpy as np
import matplotlib.pyplot as plt
import pandas as pd
import math

dataset = pd.read_csv('ds.csv')

dataset.describe()
dataset.tail()
dataset.dtypes

dataset = dataset.iloc[:, 0:5]
dataset

training_set = dataset.iloc[:, 1:2].values
training_set

from sklearn.preprocessing import MinMaxScaler
scaler = MinMaxScaler(feature_range=(0, 1))
data_training_scaled = scaler.fit_transform(training_set)

features_set = []
labels = []
for i in range(60, 586):
  features_set.append(data_training_scaled[i-60:i, 0])
  labels.append(data_training_scaled[i, 0])

features_set, labels = np.array(features_set), np.array(labels)

features_set = np.reshape(features_set, (features_set.shape[0], features_set.shape[1], 1))
features_set.shape

import tensorflow as tf
from tensorflow.python.keras.models import sequential
from tensorflow.python.keras.layers import Dense
from tensorflow.python.keras.layers import LSTM

model = sequential()
model.compile(optimizer = 'adam', loss = 'mean_squared_error')
model.fit(features_set, labels, epochs = 50, batch_size = 20)

data_testing_complete = pd.read_csv('ds.csv')
data_testing_processed = data_testing_complete.iloc[:, 1:2]
data_testing_processed

data_total = pd.concate((data_set['open'], data_set['open']), axis = 0)
test_inputs = data_total[len(data_total)- len(dataset)- 60:].values
test_inputs.shape

prediction = model.predict(test_features)

np.random.seed(1)
np.random.randn(3, 3)

np.random.normal(1)

np.random.normal(5)

plt.figure(figsize=(18, 6))
plt.title('stock market prediction')
plt.plot(data_testing_complete['close'])
plt.xlabel('Data', fontsize=18)
plt.ylabel('Total trade quantity', fontsize=18)
plt.show()